# ADR 001: Clean Architecture

<!-- Generated by Copilot -->

## Status

**Accepted**

## Context

We need to establish an architecture pattern for the TransactionService that:

- Separates concerns clearly
- Makes the codebase testable
- Allows for flexibility in technology choices
- Supports long-term maintainability

## Decision

We will use **Clean Architecture** (also known as Onion Architecture or Hexagonal Architecture) with four distinct layers:

### Layer Structure

```
1. Domain Layer (innermost)
   - No external dependencies
   - Contains entities, value objects, enums
   - Pure business logic

2. Application Layer
   - Depends only on Domain
   - Contains use cases (commands/queries)
   - DTOs and validators

3. Infrastructure Layer
   - Depends on Application and Domain
   - Implements external concerns (database, caching)
   - EF Core configurations

4. API Layer (outermost)
   - Depends on all layers
   - HTTP endpoints and middleware
   - Composition root (DI configuration)
```

### Dependency Rule

Dependencies only point inward. The Domain layer has no knowledge of outer layers.

```
API → Infrastructure → Application → Domain
```

## Consequences

### Positive

- **Testability**: Domain and Application can be tested without infrastructure
- **Flexibility**: Easy to swap databases, caching, or API frameworks
- **Maintainability**: Clear boundaries make code easier to understand
- **Independence**: Business logic is protected from external changes

### Negative

- **Initial complexity**: More projects and files to manage
- **Learning curve**: Developers need to understand layer responsibilities
- **Potential over-engineering**: For simple CRUD, might be overkill

### Mitigations

- Clear documentation of layer responsibilities
- Code templates for common patterns
- Regular architecture reviews

## References

- [Clean Architecture by Robert C. Martin](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Microsoft Clean Architecture guidance](https://docs.microsoft.com/en-us/dotnet/architecture/modern-web-apps-azure/common-web-application-architectures)

---

**Navigation**: [ADR Index](../README.md) | [Next: CQRS with MediatR](002-mediatr-cqrs.md)
