# Generate API Documentation

<!-- Generated by Copilot -->

> **Goal**: Export OpenAPI/Swagger specifications for the TransactionService API

## Prerequisites

- Service running locally on port 9400
- PowerShell or curl available

## Generate OpenAPI Specification

### Using Swagger UI

1. Start the service: `dotnet run`
2. Navigate to: `http://localhost:9400/swagger`
3. Click the `/swagger/v1/swagger.json` link
4. Save the JSON file

### Using PowerShell

```powershell
# Ensure service is running
cd ExpenseVault.TransactionService.API
Start-Process -FilePath "dotnet" -ArgumentList "run" -NoNewWindow

# Wait for startup
Start-Sleep -Seconds 5

# Download OpenAPI spec
Invoke-WebRequest -Uri "http://localhost:9400/swagger/v1/swagger.json" -OutFile "openapi.json"

# Pretty print
$json = Get-Content "openapi.json" | ConvertFrom-Json
$json | ConvertTo-Json -Depth 100 | Set-Content "openapi-formatted.json"
```

### Using curl

```bash
curl http://localhost:9400/swagger/v1/swagger.json -o openapi.json
```

## Generate Client SDKs

### Using NSwag (C# Client)

```powershell
# Install NSwag CLI
dotnet tool install -g NSwag.ConsoleCore

# Generate C# client
nswag openapi2csclient /input:openapi.json /output:TransactionServiceClient.cs /namespace:ExpenseVault.TransactionService.Client
```

### Using OpenAPI Generator

```powershell
# Install via npm
npm install @openapitools/openapi-generator-cli -g

# Generate TypeScript client
openapi-generator-cli generate -i openapi.json -g typescript-axios -o ./client-ts

# Generate Python client
openapi-generator-cli generate -i openapi.json -g python -o ./client-python
```

## Generate Static Documentation

### Using Redoc

```powershell
# Install redoc-cli
npm install -g redoc-cli

# Generate static HTML
redoc-cli bundle openapi.json -o api-docs.html
```

### Using Swagger UI Standalone

```powershell
# Download Swagger UI
Invoke-WebRequest -Uri "https://github.com/swagger-api/swagger-ui/archive/refs/tags/v5.0.0.zip" -OutFile "swagger-ui.zip"
Expand-Archive -Path "swagger-ui.zip" -DestinationPath "."

# Copy your spec
Copy-Item "openapi.json" -Destination "swagger-ui-5.0.0/dist/"

# Update index.html to point to your spec
# Open swagger-ui-5.0.0/dist/index.html in browser
```

## API Specification Structure

The generated OpenAPI spec includes:

```json
{
  "openapi": "3.0.1",
  "info": {
    "title": "ExpenseVault.TransactionService.API",
    "version": "1.0"
  },
  "paths": {
    "/api/transactions": {
      "post": { /* CreateTransaction */ }
    },
    "/api/transactions/{id}": {
      "get": { /* GetTransactionById */ }
    },
    "/api/transactions/wallet/{walletId}": {
      "get": { /* GetTransactionsByWallet */ }
    }
  },
  "components": {
    "schemas": {
      "CreateTransactionRequest": { /* ... */ },
      "TransactionDto": { /* ... */ }
    }
  }
}
```

## Automation

### CI/CD Pipeline

Add to your build pipeline:

```yaml
# .github/workflows/generate-api-docs.yml
- name: Generate API Docs
  run: |
    dotnet run --project ExpenseVault.TransactionService.API &
    sleep 10
    curl http://localhost:9400/swagger/v1/swagger.json -o docs/api/openapi.json
    kill %1
```

### Pre-commit Hook

```powershell
# .git/hooks/pre-commit
$service = Start-Process -FilePath "dotnet" -ArgumentList "run --project ExpenseVault.TransactionService.API" -PassThru
Start-Sleep -Seconds 10
Invoke-WebRequest -Uri "http://localhost:9400/swagger/v1/swagger.json" -OutFile "docs/api/openapi.json"
Stop-Process -Id $service.Id
git add docs/api/openapi.json
```

---

**Navigation**: [How-To Home](README.md) | [Documentation Map](../DOCUMENTATION_MAP.md)
